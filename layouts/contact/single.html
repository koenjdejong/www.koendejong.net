{{ define "main" }}
<article class="article">
  <h1>{{ .Title }}</h1>
  <span class="article-details">{{ .Params.subtitle }}</span>
  {{ .Content }}
</article>

<form action="javascript:void(0)" onsubmit="submitContactFrom()">
  <div class="form-field">
    <label for="name">Name:</label>
    <input id="name" required class="field" type="text" placeholder="">
  </div>
  <div class="form-field">
    <label for="email">Email:</label>
    <input id="email" required class="field" type="email">
  </div>
  <div class="form-field">
    <label for="message">Message:</label>
    â€‹<textarea id="message" class="textarea field"></textarea>
  </div>
  <button id="submit-form" class="submit" type="submit">Send</button>
  <div id="response"></div>
</form>

<script>
  function submitContactFrom() {
    let xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
      if (this.readyState === 4) {
         let response = JSON.parse(this.responseText)
          if (this.status === 200) {
        if (response.success) {
          document.getElementById("response").innerHTML = "Message sent successfully!";
          document.getElementById("submit-form").disabled = true;
        } else {
          document.getElementById("response").innerHTML = response.message;
        }
      } else {
        document.getElementById("response").innerHTML = `Something went wrong, please try again later.`;
      }
      }
    };
    xhttp.open("POST", "https://forms.koendejong.net/form/submit/", true);
    xhttp.setRequestHeader("Content-Type", "application/json;charset=UTF-8"); 
    xhttp.send(JSON.stringify({
      name: document.getElementById("name").value,
      email: document.getElementById("email").value,
      message: document.getElementById("message").value
    }));
  }
</script>

<style>
  .form-field {
    margin-bottom: 1rem;
    display: flex;
    flex-direction: column;
  }
  .field {
    font-size: 1rem;
    width: 100%;
    border: 1px solid #ccc;
    padding: 0.6rem;
    border-radius: 10px;
  }
  .textarea {
    height: 10rem;
    resize: none;
    margin-top: -1.5rem;
  }
  .submit {
    font-size: 1rem;
    margin-left: 20%;
    width: 60%;
    border: 1px solid #ccc;
    padding: 0.6rem;
    border-radius: 10px;
    background-color: rgb(90, 90, 90);
    color: #fff;
    z-index: 10;
    cursor: pointer;
  }
  .submit :hover {
    background-color: rgb(75, 75, 75);
  }
  .response {
    margin-top: 2rem;
  }
</style>
{{ end }}